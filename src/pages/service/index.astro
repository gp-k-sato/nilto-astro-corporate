---
import Layout from "../../layouts/Layout.astro";
import SectionHeading from "../../components/SectionHeading.astro";
import ServiceCard from "../../components/ServiceCard.astro";
import { fetchServices, fetchServicePage } from "../../lib/nilto.js";

let services: any[] = [];
let servicePage: any = null;

try {
  [services, servicePage] = await Promise.all([
    fetchServices(),
    fetchServicePage(),
  ]);
} catch (e) {
  console.error("サービス取得エラー:", e);
}
---

<Layout title="サービス | NILTO Demo" description="株式会社NILTO Demoのサービス紹介ページです。">
  <section class="l-main__section">
    <div class="l-main__section-inner">
      <SectionHeading ja="サービス" en="Service" />
      {servicePage && (
        <div class="p-service-lead">
          {servicePage.lead_title && (
            <h3 class="p-service-lead__ttl">{servicePage.lead_title}</h3>
          )}
          {servicePage.lead_text && (
            <p class="p-service-lead__txt">{servicePage.lead_text}</p>
          )}
        </div>
      )}
    </div>
  </section>

  <section class="l-main__section l-main__section--bg">
    <div class="l-main__section-inner">
      {services && services.length > 0 ? (
        <div class="p-service__list">
          {services.map((item: any) => (
            <ServiceCard content={item} variant="list" />
          ))}
        </div>
      ) : (
        <p>サービス情報はまだありません。</p>
      )}
    </div>
  </section>
</Layout>
